<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wahrheit oder Pflicht – Spiel</title>
  <link rel="stylesheet" href="style-spiel.css" />
  <link rel="icon" type="image/png" href="bilder/favicon-96x96.png" sizes="96x96" />
  <style>
    /* Kleine Ergänzung für Fade-In / Fade-Out */
    .fade-in {
      opacity: 1;
      transform: translateY(0);
      transition: opacity 0.4s ease, transform 0.4s ease;
      pointer-events: auto;
    }
    .fade-out {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.4s ease, transform 0.4s ease;
      pointer-events: none;
      user-select: none;
    }
  </style>
</head>
<body>

<header>
  <div class="header-inner">
    <div class="logo">🔮</div>
    <div class="title-group">
      <h1>Wahrheit oder Pflicht</h1>
      <p class="subtitle">Wähle Wahrheit oder Pflicht und lass dich überraschen!</p>
    </div>
    <div class="icon-right">🤐</div>
  </div>
</header>

<main>
  <div class="container">

    <!-- Modus-Auswahl Buttons -->
    <div id="modeSelection" class="mode-selection fade-in">
      <button id="truthBtn">Wahrheit</button>
      <button id="dareBtn">Pflicht</button>
    </div>

    <!-- Frage-Ansicht (anfangs versteckt) -->
    <div id="questionView" class="question-view fade-out" style="display:none;">
      <div class="category-label" id="categoryLabel"></div>
      <div class="question-box" id="questionBox">Frage erscheint hier...</div>
      <div class="action-buttons">
        <button id="doneBtn">Erledigt / Nächste Frage</button>
      </div>
    </div>

    <button id="backBtn" class="back-button">Zurück zur Startseite</button>
  </div>
</main>

<script>
  // Beispielhafte Fragen aus Kategorien (später aus JSON laden)
const fragenKategorien = {
  funny: {
    label: "🧃 Locker & Lustig",
    wahrheit: [
      "Was war dein peinlichstes Erlebnis?",
      "Hast du jemals laut gelacht, obwohl es unangebracht war?"
    ],
    pflicht: [
      "Tanze 30 Sekunden wie ein Huhn.",
      "Erzähle einen Witz, der alle zum Lachen bringt."
    ]
  },
  daring: {
    label: "🫱 Vertrauensbasis",
    wahrheit: [
      "Wovor hast du am meisten Angst?",
      "Hast du jemals etwas getan, das du bereut hast?"
    ],
    pflicht: [
      "Mach 10 Liegestütze.",
      "Singe ein Lied laut vor allen."
    ]
  }
};

// Aktuelle Frage + Kategorie speichern
let aktuelleKategorie = "";
let aktuelleFrage = "";
let aktuellerModus = ""; // 'wahrheit' oder 'pflicht'
let strafaufgabeAktiv = false;

// DOM Elemente
const modeSelection = document.getElementById("modeSelection");
const questionView = document.getElementById("questionView");
const truthBtn = document.getElementById("truthBtn");
const dareBtn = document.getElementById("dareBtn");
const categoryLabel = document.getElementById("categoryLabel");
const questionBox = document.getElementById("questionBox");
const doneBtn = document.getElementById("doneBtn");
const backBtn = document.getElementById("backBtn");

const actionButtons = document.querySelector('.action-buttons');

const btnStrafaufgabe = document.createElement('button');
btnStrafaufgabe.textContent = 'Strafaufgabe';
btnStrafaufgabe.classList.add('action-btn');

// Strafaufgabe Button nur bei Wahrheit sichtbar, wenn Frage angezeigt wird
function updateStrafaufgabeButtonVisibility() {
  if (aktuellerModus === 'wahrheit' && questionView.style.display !== 'none' && !strafaufgabeAktiv) {
    if (!actionButtons.contains(btnStrafaufgabe)) {
      actionButtons.appendChild(btnStrafaufgabe);
    }
    btnStrafaufgabe.style.display = 'inline-block';
  } else {
    btnStrafaufgabe.style.display = 'none';
  }
}

// Animation Helper: fade out ein Element (returns Promise)
function fadeOut(element) {
  return new Promise((resolve) => {
    element.classList.remove("fade-in");
    element.classList.add("fade-out");
    setTimeout(() => {
      if (element.style.display !== "none") element.style.display = "none";
      resolve();
    }, 400);
  });
}

// Animation Helper: fade in ein Element (returns Promise)
function fadeIn(element) {
  return new Promise((resolve) => {
    element.style.display = "flex";
    setTimeout(() => {
      element.classList.remove("fade-out");
      element.classList.add("fade-in");
      resolve();
    }, 10);
  });
}

// Hilfsfunktion: zufällige Frage aus allen Kategorien je nach Modus
function getRandomQuestion(modus) {
  const categories = Object.keys(fragenKategorien);
  const catKey = categories[Math.floor(Math.random() * categories.length)];
  const cat = fragenKategorien[catKey];
  const fragenArray = modus === "wahrheit" ? cat.wahrheit : cat.pflicht;
  const frage = fragenArray[Math.floor(Math.random() * fragenArray.length)];
  return { label: cat.label, frage };
}

// Startet neue Runde mit Wahrheit oder Pflicht
async function startRound(modus) {
  strafaufgabeAktiv = false;
  aktuellerModus = modus;

  await fadeOut(modeSelection);

  const { label, frage } = getRandomQuestion(modus);
  aktuelleKategorie = label;
  aktuelleFrage = frage;

  categoryLabel.textContent = label;
  questionBox.textContent = frage;

  await fadeIn(questionView);

  updateStrafaufgabeButtonVisibility();
}

// Nächste Runde starten, zurück zur Auswahl
async function nextRound() {
  strafaufgabeAktiv = false;
  await fadeOut(questionView);
  await fadeIn(modeSelection);
  categoryLabel.textContent = "";
  questionBox.textContent = "";
  updateStrafaufgabeButtonVisibility();
}

// Strafaufgabe anzeigen (nur Pflicht-Aufgaben aus allen Kategorien)
function showStrafaufgabe() {
  strafaufgabeAktiv = true;
  categoryLabel.textContent = "Strafaufgabe";

  // Alle Pflichtaufgaben aus allen Kategorien sammeln
  let allePflichtAufgaben = [];
  for (const catKey in fragenKategorien) {
    allePflichtAufgaben = allePflichtAufgaben.concat(fragenKategorien[catKey].pflicht);
  }

  const zufallIndex = Math.floor(Math.random() * allePflichtAufgaben.length);
  questionBox.textContent = allePflichtAufgaben[zufallIndex];

  btnStrafaufgabe.style.display = 'none'; // Button ausblenden bei Strafaufgabe
}

// Event-Listener
truthBtn.addEventListener("click", () => startRound("wahrheit"));
dareBtn.addEventListener("click", () => startRound("pflicht"));
doneBtn.addEventListener("click", nextRound);
btnStrafaufgabe.addEventListener("click", showStrafaufgabe);
backBtn.addEventListener("click", () => {
  window.location.href = "index.html";
});
</script>


</body>
</html>
