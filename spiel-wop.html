<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wahrheit oder Pflicht ‚Äì Spiel</title>
  <link rel="stylesheet" href="style-spiel.css" />
  <link rel="icon" type="image/png" href="bilder/favicon-96x96.png" sizes="96x96" />
  <style>
    /* --- Styles wie von dir, erg√§nzt f√ºr Gender-Slider mit Text --- */
    .fade-in {
      opacity: 1;
      transform: translateY(0);
      transition: opacity 0.4s ease, transform 0.4s ease;
      pointer-events: auto;
    }
    .fade-out {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.4s ease, transform 0.4s ease;
      pointer-events: none;
      user-select: none;
    }
    .mystery {
      animation: mysteryFade 0.6s ease forwards;
    }
    @keyframes mysteryFade {
      0% {
        opacity: 0;
        transform: scale(0.95) rotate(-2deg);
        filter: blur(4px);
      }
      60% {
        opacity: 0.5;
        transform: scale(1.02) rotate(1deg);
        filter: blur(2px);
      }
      100% {
        opacity: 1;
        transform: scale(1) rotate(0);
        filter: blur(0);
      }
    }
    .action-btn.strafaufgabe {
      background-color: transparent;
      color: #555;
      font-size: 0.9rem;
      padding: 0.4rem 1rem;
      border-radius: 0.4rem;
      border: 1.5px solid #aaa;
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease;
      align-self: center;
      max-width: 150px;
    }
    .action-btn.strafaufgabe:hover {
      background-color: #eee;
      color: #222;
      border-color: #888;
    }
    .straf-label {
      font-size: clamp(1.5rem, 5vw, 3rem);
      font-weight: bold;
      color: red;
      text-align: center;
      margin-bottom: 0.5rem;
    }
    .gender-toggle {
      display: none;
      justify-content: center;
      margin: 1rem auto;
      user-select: none;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    }
    .gender-toggle.visible {
      display: flex;
    }
    .gender-slider {
      position: relative;
      width: 180px;
      height: 70px;
      background: linear-gradient(90deg, #4A90E2 50%, #E94A84 50%);
      border-radius: 28px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      font-weight: 700;
      color: white;
      display: flex;
      padding: 10px 10px 6px;
      font-size: 1.7rem;
      letter-spacing: 1px;
      transition: background 0.4s ease;
      user-select: none;
    }
    .gender-slider .slider-label {
      flex: 1;
      text-align: center;
      z-index: 2;
      pointer-events: none;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 3px;
    }
    .gender-slider .slider-label .emoji {
      font-size: 2.2rem;
      line-height: 1;
      user-select: none;
    }
    .gender-slider .slider-label .label-text {
      font-size: 0.8rem;
      font-weight: 600;
      line-height: 1.1;
      letter-spacing: 0.03em;
      user-select: none;
    }
    .gender-slider .slider-thumb {
      position: absolute;
      top: 10px;
      left: 4px;
      width: 82px;
      height: 50px;
      background: white;
      border-radius: 24px;
      box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15);
      transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 1;
    }
    .gender-slider.female .slider-thumb {
      left: calc(100% - 4px - 82px);
    }
    .gender-slider:not(.female) .slider-label:first-child .emoji,
    .gender-slider:not(.female) .slider-label:first-child .label-text {
      color: #4A90E2;
    }
    .gender-slider:not(.female) .slider-label:last-child .emoji,
    .gender-slider:not(.female) .slider-label:last-child .label-text {
      color: rgba(255, 255, 255, 0.6);
    }
    .gender-slider.female .slider-label:first-child .emoji,
    .gender-slider.female .slider-label:first-child .label-text {
      color: rgba(255, 255, 255, 0.6);
    }
    .gender-slider.female .slider-label:last-child .emoji,
    .gender-slider.female .slider-label:last-child .label-text {
      color: #E94A84;
    }
    .gender-slider:hover .slider-thumb {
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.25);
    }
    @media (prefers-color-scheme: dark) {
      .gender-slider {
        background: linear-gradient(90deg, #1E3A6F 50%, #7A2B49 50%);
        box-shadow: 0 4px 14px rgba(0, 0, 0, 0.5);
      }
      .gender-slider .slider-thumb {
        background-color: #ddd;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.35);
      }
      .gender-slider:not(.female) .slider-label:first-child .emoji,
      .gender-slider:not(.female) .slider-label:first-child .label-text {
        color: #7FB7FF;
      }
      .gender-slider:not(.female) .slider-label:last-child .emoji,
      .gender-slider:not(.female) .slider-label:last-child .label-text {
        color: rgba(255, 255, 255, 0.5);
      }
      .gender-slider.female .slider-label:first-child .emoji,
      .gender-slider.female .slider-label:first-child .label-text {
        color: rgba(255, 255, 255, 0.5);
      }
      .gender-slider.female .slider-label:last-child .emoji,
      .gender-slider.female .slider-label:last-child .label-text {
        color: #F788AC;
      }
    }

    /* Weitere Styles */

    .container {
      max-width: 600px;
      margin: 1rem auto;
      padding: 0 1rem;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .mode-selection button {
      font-size: 1.5rem;
      margin: 0 1rem;
      padding: 0.8rem 2rem;
      cursor: pointer;
      border-radius: 10px;
      border: 2px solid #555;
      background: #f0f0f0;
      transition: background 0.3s ease;
    }
    .mode-selection button:hover {
      background: #ddd;
    }
    .question-view {
      margin-top: 1.5rem;
      width: 100%;
      max-width: 550px;
      min-height: 180px;
      background: #f9f9f9;
      border-radius: 12px;
      padding: 1.2rem 1.5rem;
      box-shadow: 0 2px 6px rgb(0 0 0 / 0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
      user-select: none;
    }
    .category-label {
      font-size: 0.85rem;
      font-weight: 600;
      color: #666;
      margin-bottom: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }
    .question-box {
      font-size: 1.25rem;
      text-align: center;
      min-height: 90px;
      margin-bottom: 1rem;
      user-select: text;
    }
    .action-buttons {
      display: flex;
      gap: 1rem;
    }
    #doneBtn {
      font-size: 1.1rem;
      padding: 0.5rem 1.8rem;
      cursor: pointer;
      border-radius: 8px;
      border: none;
      background-color: #4A90E2;
      color: white;
      transition: background-color 0.25s ease;
    }
    #doneBtn:hover {
      background-color: #357ABD;
    }
    #backBtn {
      margin-top: 2rem;
      font-size: 1rem;
      padding: 0.4rem 1.3rem;
      cursor: pointer;
      border-radius: 6px;
      border: 2px solid #555;
      background: #fff;
      transition: background 0.3s ease;
      user-select: none;
    }
    #backBtn:hover {
      background: #eee;
    }
  </style>
</head>
<body>
<header>
  <div class="header-inner">
    <div class="logo">üîÆ</div>
    <div class="title-group">
      <h1>Wahrheit oder Pflicht</h1>
      <p class="subtitle">W√§hle Wahrheit oder Pflicht und lass dich √ºberraschen!</p>
    </div>
    <div class="icon-right">ü§ê</div>
  </div>
</header>
<main>
  <div class="container">
    <div id="genderToggle" class="gender-toggle">
      <div id="genderSwitch" class="gender-slider" role="switch" aria-checked="false" tabindex="0">
        <div class="slider-label">
          <div class="emoji">üë¶</div>
          <div class="label-text">Junge</div>
        </div>
        <div class="slider-label" style="left: 50%;">
          <div class="emoji">üëß</div>
          <div class="label-text">M√§dchen</div>
        </div>
        <div class="slider-thumb"></div>
      </div>
    </div>

    <div id="modeSelection" class="mode-selection fade-in">
      <button id="truthBtn">Wahrheit</button>
      <button id="dareBtn">Pflicht</button>
    </div>

    <div id="questionView" class="question-view fade-out" style="display:none;">
      <div class="category-label" id="categoryLabel"></div>
      <div id="penaltyHeading" class="straf-label" style="display:none;">STRAFAUFGABE</div>
      <div class="question-box" id="questionBox">Frage erscheint hier...</div>
      <div class="action-buttons">
        <button id="doneBtn">Erledigt / N√§chste Frage</button>
        <button id="penaltyBtn" class="action-btn strafaufgabe">Strafaufgabe</button>
      </div>
    </div>

    <button id="backBtn" class="back-button">Zur√ºck zur Startseite</button>
  </div>
</main>

<script>
document.addEventListener("DOMContentLoaded", () => {
  // --- Parameter und Elemente ---
  const urlParams = new URLSearchParams(window.location.search);
  const genderParam = urlParams.get("gender") || "mixed"; // male, female, mixed
  const modeParam = urlParams.get("mode") || "mixed"; // truth, dare, mixed
  const categoriesParam = urlParams.get("categories") ? urlParams.get("categories").split(",") : [];

  const genderToggle = document.getElementById("genderToggle");
  const genderSwitch = document.getElementById("genderSwitch");
  const modeSelection = document.getElementById("modeSelection");
  const questionView = document.getElementById("questionView");
  const categoryLabel = document.getElementById("categoryLabel");
  const questionBox = document.getElementById("questionBox");
  const penaltyHeading = document.getElementById("penaltyHeading");
  const doneBtn = document.getElementById("doneBtn");
  const penaltyBtn = document.getElementById("penaltyBtn");
  const backBtn = document.getElementById("backBtn");

  // --- Beispiel-Daten (kannst du sp√§ter durch JSON laden) ---
  const questionsData = {
    funny: {
      label: "Lustig",
      wahrheit: [
        { frage: "Wann hast du das letzte Mal richtig laut gelacht?" , gender: "neutral" },
        { frage: "Was war dein lustigstes Missgeschick?" , gender: "neutral" },
      ],
      pflicht: [
        { text: "Mache eine Grimasse und halte sie 10 Sekunden." , gender: "neutral" },
        { text: "Erz√§hle einen Witz, der jeden zum Lachen bringt." , gender: "neutral" },
      ]
    },
    daring: {
      label: "Mutig",
      wahrheit: [
        { frage: "Wann hast du das letzte Mal etwas gewagt, was du eigentlich nicht wolltest?" , gender: "neutral" },
        { frage: "Was ist deine gr√∂√üte Angst?" , gender: "neutral" },
      ],
      pflicht: [
        { text: "Springe einmal auf und runter." , gender: "neutral" },
        { text: "Schreibe eine kurze Nachricht an jemanden, der dich nervt." , gender: "neutral" },
      ]
    },
    taboo: {
      label: "Tabuzone",
      wahrheit: [
        { frage: "Was ist dein geheimster Wunsch?" , gender: "male" },
        { frage: "Wann hast du zuletzt eine Liebeserkl√§rung gemacht?" , gender: "female" },
        { frage: "Was war das verr√ºckteste, was du heimlich gemacht hast?" , gender: "neutral" }
      ],
      pflicht: [
        { text: "Fl√ºstere jemandem ein geheimes Kompliment zu." , gender: "neutral" },
        { text: "Schicke eine peinliche Nachricht an deinen Crush." , gender: "female" },
        { text: "Trinke einen Schluck Wasser mit geschlossenen Augen." , gender: "male" }
      ]
    }
  };

  // --- Status ---
  let currentGender = "male";
  let currentMode = "truth"; // Wahrheit oder Pflicht
  let currentCategory = null;
  let currentQuestion = null;
  let isPenalty = false;

  // --- Initial Setup ---

  // Sichtbarkeit GenderToggle regeln
  if (genderParam === "mixed") {
    genderToggle.classList.add("visible");
    currentGender = sessionStorage.getItem("currentGender") || "male";
  } else {
    genderToggle.classList.remove("visible");
    currentGender = genderParam;
    sessionStorage.setItem("currentGender", currentGender);
  }
  setGenderClass(currentGender);

  // Hilfsfunktion GenderSlider setzen
  function setGenderClass(gender) {
    genderSwitch.classList.toggle("female", gender === "female");
    sessionStorage.setItem("currentGender", gender);
  }

  // Event GenderSwitch Click
  if (genderToggle.classList.contains("visible")) {
    genderSwitch.addEventListener("click", () => {
      currentGender = currentGender === "male" ? "female" : "male";
      setGenderClass(currentGender);
    });
  }

  // Modus-Voreinstellung
  currentMode = modeParam === "truth" || modeParam === "dare" ? modeParam : "mixed";

  // Frage-Tasten
  const truthBtn = document.getElementById("truthBtn");
  const dareBtn = document.getElementById("dareBtn");

  // Event Wahrheit oder Pflicht w√§hlen
  truthBtn.addEventListener("click", () => {
    currentMode = "truth";
    loadQuestion();
    toggleView();
  });
  dareBtn.addEventListener("click", () => {
    currentMode = "dare";
    loadQuestion();
    toggleView();
  });

  // Frage laden - filter nach Kategorie & Gender
  function loadQuestion() {
    isPenalty = false;
    penaltyHeading.style.display = "none";

    // Filter Kategorien - falls keine Auswahl: alle Kategorien
    let availableCategories = categoriesParam.length > 0 ? categoriesParam : Object.keys(questionsData);

    // Filter nach Kategorie, Modus und Gender
    // Gender in Frage / Pflicht als "male", "female" oder "neutral"
    let filteredQuestions = [];

    for (const catKey of availableCategories) {
      const catData = questionsData[catKey];
      if (!catData) continue;

      const questionsArray = currentMode === "truth" ? catData.wahrheit : catData.pflicht;

      const filtered = questionsArray.filter(q => {
        // Wenn gender neutral oder match currentGender, dann erlauben
        return !q.gender || q.gender === "neutral" || q.gender === currentGender;
      }).map(q => ({
        ...q,
        category: catData.label
      }));

      filteredQuestions.push(...filtered);
    }

    if (filteredQuestions.length === 0) {
      questionBox.textContent = "Keine passenden Fragen gefunden.";
      currentQuestion = null;
      return;
    }

    // Zuf√§llige Frage w√§hlen
    const randomIndex = Math.floor(Math.random() * filteredQuestions.length);
    currentQuestion = filteredQuestions[randomIndex];

    // Frage anzeigen
    categoryLabel.textContent = currentQuestion.category;
    questionBox.textContent = currentMode === "truth" ? currentQuestion.frage : currentQuestion.text;
  }

  // Umschalten zwischen Modus-Auswahl und Frage-Ansicht
  function toggleView() {
    if (modeSelection.classList.contains("fade-in")) {
      modeSelection.classList.remove("fade-in");
      modeSelection.classList.add("fade-out");
      setTimeout(() => {
        modeSelection.style.display = "none";
        questionView.style.display = "flex";
        questionView.classList.remove("fade-out");
        questionView.classList.add("fade-in");
      }, 400);
    } else {
      questionView.classList.remove("fade-in");
      questionView.classList.add("fade-out");
      setTimeout(() => {
        questionView.style.display = "none";
        modeSelection.style.display = "flex";
        modeSelection.classList.remove("fade-out");
        modeSelection.classList.add("fade-in");
        penaltyHeading.style.display = "none";
        isPenalty = false;
        currentQuestion = null;
      }, 400);
    }
  }

  // Button "Erledigt / N√§chste Frage"
  doneBtn.addEventListener("click", () => {
    loadQuestion();
  });

  // Button "Strafaufgabe"
  penaltyBtn.addEventListener("click", () => {
    if (!currentQuestion) return;
    isPenalty = true;
    penaltyHeading.style.display = "block";
    // Text √§ndern je nach Pflicht oder Wahrheit
    questionBox.textContent = currentMode === "truth"
      ? "Erledige jetzt die Strafaufgabe!"
      : "Hier kommt deine Strafaufgabe!";
  });

  // Button "Zur√ºck zur Startseite" reloadet aktuell die Seite
  backBtn.addEventListener("click", () => {
    window.location.href = "/"; // Oder eine echte Startseite, anpassen wie gew√ºnscht
  });

  console.log("Gew√§hltes Geschlecht:", currentGender);
  console.log("Modus:", currentMode);
  console.log("Kategorien:", categoriesParam);

});
</script>
</body>
</html>
